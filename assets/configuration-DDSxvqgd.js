import{Ct as e,Dt as t,Gt as n,Kt as r,Lt as i,Ot as a,Pt as o,St as s,an as c,in as l,nn as u,on as d,rn as f,wt as p,yt as m,zt as h}from"./index-DTcm7Ef5.js";var g={class:`configuration-container`},_={class:`configuration-content`},v={class:`section-card`},y={class:`form-grid-2`},b={class:`form-group`},x={class:`form-group`},S={class:`form-group`},C={class:`form-group`},w={class:`form-group`},T={class:`section-card`},E={class:`personalization-grid`},D={class:`checkbox-group`},O={class:`checkbox-group`},k={class:`checkbox-group`},A={class:`checkbox-group`},j={class:`checkbox-group`},M={class:`checkbox-group`},N={class:`section-card`},P={class:`security-grid`},F={class:`form-group`},I={class:`form-group`},L={class:`form-group`},R=s({__name:`configuration`,setup(s){let R=e(),{kpiCurrent:z,kpiCost:B,kpiMonthly:V,chartHourly:H,chartMonthly:U,chartDevice:W}=p(R);function G(){try{return JSON.parse(localStorage.getItem(`energix-user`))?.id||1}catch{return 1}}let K=l({name:``,lastName:``,email:``,dni:``,district:``,invoiceFileName:``});l({baseRate:`S`,dailyLimit:`8`,enableDailySummary:!1,dailySummary:!1,limit80:!1,unusualAlert:!1});let q=l({currentPassword:``,newPassword:``,confirmPassword:``});c(null),n(()=>{let e=JSON.parse(localStorage.getItem(`energix-user`));e&&(K.name=e.name||``,K.lastName=e.lastName||``,K.email=e.email||``,K.dni=e.dni||``,K.district=e.district||``),R.loadPersonalization()});let J=async()=>{try{let e=G(),t=await fetch(`http://localhost:3001/api/v1/users/${e}`,{method:`PATCH`,headers:{"Content-Type":`application/json`},body:JSON.stringify({name:K.name,lastName:K.lastName,email:K.email,dni:K.dni,district:K.district})});if(!t.ok){let e=await t.json().catch(()=>({}));throw Error(e.message||`Error al guardar el perfil`)}let n=JSON.parse(localStorage.getItem(`energix-user`));Object.assign(n,{name:K.name,lastName:K.lastName,email:K.email,dni:K.dni,district:K.district}),localStorage.setItem(`energix-user`,JSON.stringify(n)),alert(`Perfil guardado correctamente`)}catch(e){alert(e.message||`Error al guardar el perfil`)}},Y=()=>{alert(`Cambios cancelados`)},X=()=>{R.savePersonalization(),alert(`Personalización guardada y reflejada en el Dashboard`)},Z=()=>{R.resetToDefaults(),alert(`Personalización restablecida`)},Q=async()=>{if(q.newPassword!==q.confirmPassword){alert(`Las contraseñas no coinciden`);return}try{let e=G();await m(e,q.currentPassword,q.newPassword),alert(`Contraseña actualizada correctamente`),q.currentPassword=``,q.newPassword=``,q.confirmPassword=``}catch(e){alert(e.message||`Error al actualizar la contraseña`)}};return(e,n)=>(r(),i(`div`,g,[o(`div`,_,[n[31]||=h(`<h2 class="main-title" data-v-3032741e>Configuración</h2><p class="subtitle" data-v-3032741e> Plan actual: <span class="highlight" data-v-3032741e>Plan Estudiantil</span> | Historial: <span class="highlight" data-v-3032741e>90 días</span> | Dispositivos: <span class="highlight" data-v-3032741e>2</span></p>`,2),o(`div`,v,[n[19]||=o(`h3`,{class:`section-title`},`Perfil`,-1),o(`div`,y,[o(`div`,b,[n[14]||=o(`label`,{class:`form-label`},`Nombre`,-1),u(o(`input`,{"onUpdate:modelValue":n[0]||=e=>K.name=e,type:`text`,placeholder:`Jorge`,class:`form-input`},null,512),[[a,K.name]])]),o(`div`,x,[n[15]||=o(`label`,{class:`form-label`},`Apellido`,-1),u(o(`input`,{"onUpdate:modelValue":n[1]||=e=>K.lastName=e,type:`text`,placeholder:`Benavides`,class:`form-input`},null,512),[[a,K.lastName]])]),o(`div`,S,[n[16]||=o(`label`,{class:`form-label`},`Correo`,-1),u(o(`input`,{"onUpdate:modelValue":n[2]||=e=>K.email=e,type:`email`,placeholder:`jorge12@gmail.com`,class:`form-input`},null,512),[[a,K.email]])]),o(`div`,C,[n[17]||=o(`label`,{class:`form-label`},`DNI`,-1),u(o(`input`,{"onUpdate:modelValue":n[3]||=e=>K.dni=e,type:`text`,placeholder:`99999999`,class:`form-input`},null,512),[[a,K.dni]])]),o(`div`,w,[n[18]||=o(`label`,{class:`form-label`},`Distrito`,-1),u(o(`input`,{"onUpdate:modelValue":n[4]||=e=>K.district=e,type:`text`,placeholder:`Miraflores`,class:`form-input`},null,512),[[a,K.district]])])]),o(`div`,{class:`button-group`},[o(`button`,{onClick:J,class:`btn-primary`},`Guardar cambios`),o(`button`,{onClick:Y,class:`btn-secondary`},`Cancelar`)])]),o(`div`,T,[n[26]||=o(`h3`,{class:`section-title`},`Personalización del panel`,-1),o(`div`,E,[o(`div`,D,[u(o(`input`,{type:`checkbox`,id:`kpiCurrent`,"onUpdate:modelValue":n[5]||=e=>f(z)?z.value=e:null,class:`form-checkbox`},null,512),[[t,d(z)]]),n[20]||=o(`label`,{for:`kpiCurrent`,class:`checkbox-label`},`KPI Consumo actual`,-1)]),o(`div`,O,[u(o(`input`,{type:`checkbox`,id:`kpiCost`,"onUpdate:modelValue":n[6]||=e=>f(B)?B.value=e:null,class:`form-checkbox`},null,512),[[t,d(B)]]),n[21]||=o(`label`,{for:`kpiCost`,class:`checkbox-label`},`KPI Costo estimado`,-1)]),o(`div`,k,[u(o(`input`,{type:`checkbox`,id:`kpiMonthly`,"onUpdate:modelValue":n[7]||=e=>f(V)?V.value=e:null,class:`form-checkbox`},null,512),[[t,d(V)]]),n[22]||=o(`label`,{for:`kpiMonthly`,class:`checkbox-label`},`KPI Consumo mensual`,-1)]),o(`div`,A,[u(o(`input`,{type:`checkbox`,id:`chartHourly`,"onUpdate:modelValue":n[8]||=e=>f(H)?H.value=e:null,class:`form-checkbox`},null,512),[[t,d(H)]]),n[23]||=o(`label`,{for:`chartHourly`,class:`checkbox-label`},`Gráfico: Consumo por hora (hoy)`,-1)]),o(`div`,j,[u(o(`input`,{type:`checkbox`,id:`chartMonthly`,"onUpdate:modelValue":n[9]||=e=>f(U)?U.value=e:null,class:`form-checkbox`},null,512),[[t,d(U)]]),n[24]||=o(`label`,{for:`chartMonthly`,class:`checkbox-label`},`Gráfico: Consumo este mes (ahorro)`,-1)]),o(`div`,M,[u(o(`input`,{type:`checkbox`,id:`chartDevice`,"onUpdate:modelValue":n[10]||=e=>f(W)?W.value=e:null,class:`form-checkbox`},null,512),[[t,d(W)]]),n[25]||=o(`label`,{for:`chartDevice`,class:`checkbox-label`},`Gráfico: Consumo por dispositivo (Status)`,-1)])]),o(`div`,{class:`button-group`},[o(`button`,{onClick:X,class:`btn-primary`},`Guardar cambios`),o(`button`,{onClick:Z,class:`btn-secondary`},`Restablecer`)])]),o(`div`,N,[n[30]||=o(`h3`,{class:`section-title`},`Seguridad`,-1),o(`div`,P,[o(`div`,F,[n[27]||=o(`label`,{class:`form-label`},`Contraseña actual`,-1),u(o(`input`,{"onUpdate:modelValue":n[11]||=e=>q.currentPassword=e,type:`password`,class:`form-input`},null,512),[[a,q.currentPassword]])]),o(`div`,I,[n[28]||=o(`label`,{class:`form-label`},`Nueva contraseña`,-1),u(o(`input`,{"onUpdate:modelValue":n[12]||=e=>q.newPassword=e,type:`password`,class:`form-input`},null,512),[[a,q.newPassword]])]),o(`div`,L,[n[29]||=o(`label`,{class:`form-label`},`Confirmar contraseña`,-1),u(o(`input`,{"onUpdate:modelValue":n[13]||=e=>q.confirmPassword=e,type:`password`,class:`form-input`},null,512),[[a,q.confirmPassword]])])]),o(`div`,{class:`button-container`},[o(`button`,{onClick:Q,class:`btn-primary`},`Actualizar contraseña`)])])])]))}},[[`__scopeId`,`data-v-3032741e`]]);export{R as default};